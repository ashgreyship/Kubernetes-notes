# 云原生（Cloud Native）的介绍

## 云原生（Cloud Native）的定义

CNCF对云原生（Cloud Native）的定义包含以下三个方面：

* 应用容器化
* 面向微服务架构
* 应用支持容器的编排调度

以下是CNCF对云原生的重新定义:

**云原生技术**有利于各组织在**公有云、私有云和混合云**等新型动态环境中，**构建和运行可弹性扩展的应用**。云原生的代表技术包括容器、服务网格、微服务、不可变基础设施和声明式API。

这些技术**能够构建**_容错性好_、_易于管理_和_便于观察_的_松耦合系统_。结合可靠的自动化手段，云原生技术使工程师能够轻松地对系统作出频繁和可预测的重大变更。

云原生计算基金会（CNCF）致力于培育和维护一个厂商中立的开源生态系统，来推广云原生技术。我们通过将最前沿的模式民主化，让这些创新为大众所用。

## 云原生应用程序

云原生应用程序被设计为在平台上运行，并设计用于弹性，敏捷性，可操作性和可观察性。

以下是实现云原生应用程序所需特性的常用方法：

* 微服务
* 健康报告
* 遥测数据
* 弹性
* 声明式的，而不是命令式的

### 微服务

将明确定义的功能分成更小的服务，并让每个服务独立迭代。这增加了应用程序的灵活性，允许根据需要更轻松地更改部分应用程序。每个微服务可以由单独的团队进行管理，使用适当的语言编写，并根据需要进行独立扩缩容。

### 健康报告

为了提高云原生应用程序的可操作性，应用程序应该暴露健康检查。开发人员可以将其实施为命令或过程信号，以便应用程序在执行自我检查之后响应，或者更常见的是：通过应用程序提供Web服务，返回HTTP状态码来检查健康状态。将健康责任转移到应用程序中使应用程序更容易管理和自动化。

提供健康检查的应用程序示例包括Zookeeper的ruok命令和etcd的HTTP / 健康端点。

应用程序不仅仅有健康或不健康的状态。在应用程序启动和关闭过程中，应用程序也会向平台报告它的相应状态。

#### 例子

健康检查包括平台判断应用程序何时可以接收流量。在应用程序启动时，如果它不能正确处理流量，它就应该报告它的状态是`未准备好,`此额外状态将防止应用程序过早终止。如果应用程序不报告此额外状态, 则运行状况检查失败，平台可能会认为应用程序不健康，并且会反复停止或重新启动它。

### 遥测数据

健康报告通知我们应用程序生命周期状态，而遥测数据通知我们应用程序业务目标。

测量的指标有时称为服务级指标（SLI）或关键性能指标（KPI）。这些是特定于应用程序的数据，可以确保应用程序的性能处于服务级别目标（SLO）内。

#### 遥测和度量标准用于解决以下问题：

* 应用程序每分钟收到多少请求？
* 有没有错误？
* 什么是应用程序延迟？
* 订购需要多长时间？

#### RED 方法

能较好实施度量标准的方法，用于收集应用程序的速率，错误和执行时间。

* **请求率:** 收到了多少个请求
* **错误:** 应用程序有多少错误
* **时间:** 多久才能收到回复

### 健康报告和遥测数据的区别

遥测数据应该用于提醒而非健康监测。在动态的、自我修复的环境中，我们更少关注单个应用程序实例的生命周期，更多关注关于整体应用程序SLO的内容。

如果1个实例或50个应用程序不健康，只要满足应用程序的业务需求，我们可能不会收到警报。

### 弹性

一旦你有遥测和监测数据，你需要确保你的应用程序对故障有适应能力。弹性是基础设施的责任，但云原生应用程序也需要承担部分工作。使用云原生应用程序，应用程序有责任接受失败而不是避免失败。

在云原生应用程序中考虑弹性的两个主要方面：为失败设计和优雅降级。

#### **为失败设计**

无论发生什么故障，云原生应用程序都应该是可适应的。他们期望失败，所以他们在检测到时进行调整。

**优雅降级**

云原生应用程序需要有一种方法来处理过载，无论它是应用程序还是负载下的相关服务。处理负载的一种方式是优雅降级。

### **声明式,非反应式**

在云原生应用程序中，与任何事物进行通信的方式都是通过网络进行的。很多时候，网络通信都是通过RESTful HTTP调用完成的，但它也可以通过其他接（如远程过程调用（RPC））来实现。





